<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Inventario de Bebidas - Tema Negro Puro</title>
    <style>
        /* BODY Y FUENTES */
        body {
            font-family: "Fira Sans", Arial, sans-serif;
            margin: 20px;
            background-color: #000000;
            /* Negro Puro */
            color: #ffffff;
            /* Texto blanco */
        }

        /* LOGO y TÍTULO */
        #logo {
            text-align: left;
            margin: 10px 0 20px 10px;
        }

        #logo img {
            max-width: 150px;
            display: block;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #e0e0e0;
            /* Blanco suave */
            margin-top: 0;
        }

        /* FORMULARIO Y BUSCADOR */
        #formulario,
        #buscador {
            text-align: center;
            margin-bottom: 20px;
        }

        #formulario input,
        #buscador input,
        .accion-input {
            /* Estilo unificado para inputs, incluido el nuevo de acción */
            padding: 6px 12px;
            margin: 0 5px 10px 0;
            border-radius: 4px;
            border: 1px solid #333333;
            background-color: #1a1a1a;
            color: #ffffff;
            outline: none;
            font-size: 14px;
            box-sizing: border-box;
            /* Importante para el tamaño del input */
        }

        /* TABLA */
        table {
            width: 90%;
            margin: auto;
            border-collapse: collapse;
            background: #111111;
            /* Negro muy oscuro para la tabla */
            color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
        }

        th,
        td {
            padding: 14px;
            text-align: center;
            border-bottom: 1px solid #333333;
        }

        th {
            cursor: pointer;
            background: #222222;
            /* Fondo de cabecera gris oscuro */
            user-select: none;
            transition: background 0.3s;
        }

        th:hover {
            background: #333333;
            /* Hover gris más claro */
        }

        /* BOTONES */
        button {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 5px 10px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            color: black;
            font-size: 14px;
            transition: all 0.2s;
            margin: 2px;
            /* Añadido para separar los nuevos botones */
        }

        button.sumar {
            background: #cccccc;
            /* Gris claro (Positivo) */
        }

        button.restar {
            background: #888888;
            /* Gris medio (Negativo) */
        }

        button.eliminar {
            background: #b58900;
            /* Amarillo dorado para alerta de eliminar */
            color: white;
        }

        button:hover {
            opacity: 0.85;
        }

        /* INPUT DE BUSCADOR */
        #inputBuscar {
            width: 300px;
        }
    </style>
</head>

<body>
    <div id="logo">
        <img src="logo.png" alt="Logo">
    </div>

    <h1>Inventario de Bebidas</h1>

    <div id="buscador">
        <input type="text" id="inputBuscar" placeholder="Buscar artículo o tipo" onkeyup="filtrarTabla()">
    </div>

    <div id="formulario">
        <input type="text" id="nuevoArticulo" placeholder="Artículo">
        <input type="text" id="nuevoTipo" placeholder="Tipo">
        <input type="number" id="nuevaCantidad" placeholder="Cantidad" min="0" step="0.01">
        <button onclick="agregarArticulo()">Añadir</button>
    </div>

    <table id="tabla">
        <tr>
            <th onclick="ordenarTabla(0)">Artículo ▲▼</th>
            <th onclick="ordenarTabla(1)">Tipo ▲▼</th>
            <th onclick="ordenarTabla(2, true)">Cantidad ▲▼</th>
            <th>Acciones</th>
        </tr>
    </table>

    <script>
        let ordenAsc = true;

        // **NUEVA FUNCIÓN 1: Poner la cantidad a cero**
        function ponerCero(id) {
            let celda = document.getElementById(id);
            if (celda) {
                celda.textContent = "0";
                guardarLocalStorage();
            }
        }

        // **NUEVA FUNCIÓN 2: Establecer una cantidad específica**
        function establecerCantidad(id) {
            let inputId = "inputSet" + id;
            let input = document.getElementById(inputId);
            // Reemplazar coma por punto para el parseo
            let nuevaCantidad = parseFloat(input.value.replace(',', '.'));

            if (isNaN(nuevaCantidad) || nuevaCantidad < 0) {
                alert("Introduce una cantidad válida (número positivo).");
                return;
            }

            let celda = document.getElementById(id);
            if (celda) {
                // Redondear a 2 decimales para consistencia
                nuevaCantidad = Math.round((nuevaCantidad + Number.EPSILON) * 100) / 100;
                celda.textContent = nuevaCantidad.toString().replace('.', ',');
                input.value = ""; // Limpiar el input después de establecer
                guardarLocalStorage();
            }
        }

        // FUNCIÓN EXISTENTE: Ajustar por delta
        function ajustar(id, delta) {
            let celda = document.getElementById(id);
            if (!celda) return;

            let valor = parseFloat(celda.textContent.replace(',', '.')) || 0;
            valor += delta;
            if (valor < 0) valor = 0;
            valor = Math.round((valor + Number.EPSILON) * 100) / 100; // 2 decimales
            celda.textContent = valor.toString().replace('.', ',');
            guardarLocalStorage();
        }

        // FUNCIÓN EXISTENTE: Eliminar Fila
        function eliminarFila(boton) {
            let fila = boton.parentNode.parentNode;
            fila.parentNode.removeChild(fila);
            guardarLocalStorage();
        }

        // FUNCIÓN EXISTENTE: Añadir Artículo
        function agregarArticulo() {
            let nombre = document.getElementById("nuevoArticulo").value.trim();
            let tipo = document.getElementById("nuevoTipo").value.trim();
            let cantidad = parseFloat(document.getElementById("nuevaCantidad").value.replace(',', '.'));

            if (!nombre || !tipo || isNaN(cantidad)) {
                alert("Rellena todos los campos correctamente.");
                return;
            }

            agregarFila(nombre, tipo, cantidad);
            document.getElementById("nuevoArticulo").value = "";
            document.getElementById("nuevoTipo").value = "";
            document.getElementById("nuevaCantidad").value = "";
            guardarLocalStorage();
        }

        // FUNCIÓN EXISTENTE: Agregar Fila (MODIFICADA para incluir las nuevas acciones)
        function agregarFila(nombre, tipo, cantidad) {
            let tabla = document.getElementById("tabla");
            let fila = tabla.insertRow(-1);

            let celda1 = fila.insertCell(0); celda1.textContent = nombre;
            let celda2 = fila.insertCell(1); celda2.textContent = tipo;

            let celda3 = fila.insertCell(2);
            let celdaId = "c" + Date.now() + Math.floor(Math.random() * 1000);
            celda3.id = celdaId;
            celda3.textContent = cantidad.toString().replace('.', ',');

            let celda4 = fila.insertCell(3);
            celda4.innerHTML = `
                <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 5px;">
                    <button class="sumar" onclick="ajustar('${celdaId}',1)">+1</button>
                    <button class="restar" onclick="ajustar('${celdaId}',-1)">-1</button>
                    <button class="sumar" onclick="ajustar('${celdaId}',0.1)">+0,1</button>
                    <button class="restar" onclick="ajustar('${celdaId}',-0.1)">-0,1</button>
                    
                    <button class="restar" onclick="ponerCero('${celdaId}')">Poner a 0</button>
                    
                    <input type="number" id="inputSet${celdaId}" placeholder="Cantidad" min="0" step="0.01" class="accion-input" style="width: 60px;">
                    <button class="sumar" onclick="establecerCantidad('${celdaId}')">Establecer</button>

                    <button class="eliminar" onclick="eliminarFila(this)">Eliminar</button>
                </div>
            `;
        }

        // FUNCIÓN EXISTENTE: Ordenar Tabla
        function ordenarTabla(columna, numerico = false) {
            let tabla = document.getElementById("tabla");
            let filas = Array.from(tabla.rows).slice(1);
            filas.sort((a, b) => {
                let A = a.cells[columna].textContent;
                let B = b.cells[columna].textContent;
                if (numerico) {
                    A = parseFloat(A.replace(',', '.')) || 0;
                    B = parseFloat(B.replace(',', '.')) || 0;
                    return ordenAsc ? A - B : B - A;
                } else {
                    return ordenAsc ? A.localeCompare(B) : B.localeCompare(A);
                }
            });
            filas.forEach(f => tabla.appendChild(f));
            ordenAsc = !ordenAsc;
        }

        // FUNCIÓN EXISTENTE: Filtrar Tabla
        function filtrarTabla() {
            let input = document.getElementById("inputBuscar").value.toLowerCase();
            let tabla = document.getElementById("tabla");
            let filas = Array.from(tabla.rows).slice(1);
            filas.forEach(fila => {
                let articulo = fila.cells[0].textContent.toLowerCase();
                let tipo = fila.cells[1].textContent.toLowerCase();
                fila.style.display = (articulo.includes(input) || tipo.includes(input)) ? "" : "none";
            });
        }

        // FUNCIÓN EXISTENTE: Guardar en LocalStorage
        function guardarLocalStorage() {
            let tabla = document.getElementById("tabla");
            let filas = Array.from(tabla.rows).slice(1);
            let inventario = filas.map(f => {
                return {
                    articulo: f.cells[0].textContent,
                    tipo: f.cells[1].textContent,
                    cantidad: f.cells[2].textContent
                };
            });
            localStorage.setItem("inventarioBebidas", JSON.stringify(inventario));
        }

        // FUNCIÓN EXISTENTE: Cargar Inventario
        function cargarLocalStorage() {
            let inventario = JSON.parse(localStorage.getItem("inventarioBebidas"));
            if (inventario && inventario.length > 0) {
                inventario.forEach(item => agregarFila(item.articulo, item.tipo, parseFloat(item.cantidad.replace(',', '.'))));
            } else {
                // Artículos iniciales
                agregarFila("Johnnie Walker Red Label", "Whisky", 10);
                agregarFila("Jameson Irish Whiskey", "Whisky", 8);
                agregarFila("Jack Daniel's Old No. 7", "Whisky", 12);
                agregarFila("Absolut Vodka", "Vodka", 9);
                agregarFila("Smirnoff Vodka", "Vodka", 11);
                agregarFila("Grey Goose Vodka", "Vodka", 4);
                agregarFila("Larios 12", "Ginebra", 7);
                agregarFila("Tanqueray London Dry", "Ginebra", 5);
                agregarFila("Beefeater", "Ginebra", 6);
                agregarFila("Heineken", "Cerveza", 24);
                guardarLocalStorage();
            }
        }

        // CARGAR AL INICIAR
        cargarLocalStorage();
    </script>
</body>

</html>